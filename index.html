<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Zoning Code Analysis • zoneR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Zoning Code Analysis">
<meta name="description" content="The zoneR package was built to analyze housing capacity under existing zoning laws. It is designed to work with OZFS files (*.bldg, *.parcel, *.zoning).">
<meta property="og:description" content="The zoneR package was built to analyze housing capacity under existing zoning laws. It is designed to work with OZFS files (*.bldg, *.parcel, *.zoning).">
<meta property="og:image" content="https://vibe-lab-gsd.github.io/zoneR/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">zoneR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vibe-lab-gsd/zoneR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="zoner">zoneR<a class="anchor" aria-label="anchor" href="#zoner"></a>
</h1>
</div>
<!-- badges: start -->
<!-- badges: end -->
<p>Analyze the housing capacity of cities using Open Zoning Feed Specification (OZFS) data.</p>
<p>The main function of zoneR is <code><a href="reference/zr_run_zoning_checks.html">zr_run_zoning_checks()</a></code> which reads in an OZFS <code>.bldg</code>, <code>.parcel</code>, and <code>.zoning</code> file. It calculates the zoning requirements for each parcel, checks them against the building characteristics, and returns a data frame with a row for each parcel and an “allowed” column containing one of three possible values.</p>
<ul>
<li><p><code>TRUE</code>: The building is allowed on the parcel</p></li>
<li><p><code>FALSE</code>: The building is not allowed on the parcel</p></li>
<li><p><code>MAYBE</code>: The building might be allowed on the parcel depending on conditions that are not yet possible to express in OZFS.</p></li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of zoneR from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"vibe-lab-gsd/zoneR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example of finding which parcels in Paradise, TX allow a duplex with a gross floor area of 3200 square feet and a height of 45 feet. Small OZFS files accessible through the package will be used in the example.</p>
<p>We get the file paths for the example OZFS files using <code><a href="reference/zr_example_files.html">zr_example_files()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vibe-lab-gsd/zoneR" class="external-link">zoneR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">bldg_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/zr_example_files.html">zr_example_files</a></span><span class="op">(</span><span class="st">"2_fam.bldg"</span><span class="op">)</span></span>
<span><span class="va">parcel_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/zr_example_files.html">zr_example_files</a></span><span class="op">(</span><span class="st">"Paradise.parcel"</span><span class="op">)</span></span>
<span><span class="va">zoning_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/zr_example_files.html">zr_example_files</a></span><span class="op">(</span><span class="st">"Paradise.zoning"</span><span class="op">)</span></span></code></pre></div>
<p>We can then put each of the files into the <code><a href="reference/zr_run_zoning_checks.html">zr_run_zoning_checks()</a></code> function and assign the result to a variable called zoning_checks.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zoning_checks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/zr_run_zoning_checks.html">zr_run_zoning_checks</a></span><span class="op">(</span>bldg_file <span class="op">=</span> <span class="va">bldg_path</span>,</span>
<span>                                      parcel_files <span class="op">=</span> <span class="va">parcel_path</span>,</span>
<span>                                      zoning_files <span class="op">=</span> <span class="va">zoning_path</span><span class="op">)</span></span>
<span><span class="co">#&gt; ___data_prep___(0.4 sec)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ___get_zoning_req___(0.9 sec)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ___initial_checks___(0.5 sec)</span></span>
<span><span class="co">#&gt; 21 parcels are TRUE or MAYBE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ___bldg_fit___(28.6 sec)</span></span>
<span><span class="co">#&gt; 9 parcels are TRUE or MAYBE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; _____summary_____</span></span>
<span><span class="co">#&gt; total runtime: 30.3 sec (0.51 min)</span></span>
<span><span class="co">#&gt; 0 / 421 parcels allow the building</span></span>
<span><span class="co">#&gt; 11 / 421 parcels might allow the building</span></span></code></pre></div>
<p>The result of the function is a simple features data frame with the following columns: “parcel_id”, “allowed”, “reason”, “geometry.” Note that the geometry is the centroid of the parcel.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">zoning_checks</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -97.69917 ymin: 33.1448 xmax: -97.69153 ymax: 33.15607</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt;                           parcel_id allowed                         reason</span></span>
<span><span class="co">#&gt; 1     Wise_County_combined_parcel_1   FALSE               res_type, height</span></span>
<span><span class="co">#&gt; 2 Wise_County_combined_parcel_10300   FALSE               res_type, height</span></span>
<span><span class="co">#&gt; 3 Wise_County_combined_parcel_10450   FALSE               res_type, height</span></span>
<span><span class="co">#&gt; 4 Wise_County_combined_parcel_10451   FALSE res_type, height, unit_density</span></span>
<span><span class="co">#&gt; 5 Wise_County_combined_parcel_10452   FALSE res_type, height, unit_density</span></span>
<span><span class="co">#&gt; 6 Wise_County_combined_parcel_10464   FALSE               res_type, height</span></span>
<span><span class="co">#&gt;                     geometry</span></span>
<span><span class="co">#&gt; 1 POINT (-97.69524 33.14755)</span></span>
<span><span class="co">#&gt; 2 POINT (-97.69382 33.15607)</span></span>
<span><span class="co">#&gt; 3  POINT (-97.69415 33.1448)</span></span>
<span><span class="co">#&gt; 4 POINT (-97.69156 33.14562)</span></span>
<span><span class="co">#&gt; 5 POINT (-97.69153 33.14699)</span></span>
<span><span class="co">#&gt; 6 POINT (-97.69917 33.15142)</span></span></code></pre></div>
<p>The graph below is a visualization of the results. <img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<p>It appears this duplex would not be allowed in most the Paradise parcels. To look further into the reasons, we can specify the checks we want to be run and look at those results. Since land use regulations are often a distinguishing factor in allowing a building on a parcel, only the res_type check will be run in this next example. We will also put <code>print_checkpoints = FALSE</code> because we don’t really need it to tell us when it is done with the different parts of the function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zoning_checks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/zr_run_zoning_checks.html">zr_run_zoning_checks</a></span><span class="op">(</span>bldg_file <span class="op">=</span> <span class="va">bldg_path</span>,</span>
<span>                                      parcel_files <span class="op">=</span> <span class="va">parcel_path</span>,</span>
<span>                                      zoning_files <span class="op">=</span> <span class="va">zoning_path</span>, </span>
<span>                                      checks <span class="op">=</span> <span class="st">"res_type"</span>,</span>
<span>                                      print_checkpoints <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; zoning checks finished</span></span>
<span><span class="co">#&gt; total runtime: 1.3 sec (0.02 min)</span></span></code></pre></div>
<p>Now we can see that only a few of the parcels are in a district that allows buildings with two units. It makes sense why there were only a few parcels in the previous check that might have allowed the building. <img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<p>Here are a few other constraint checks to visualize.</p>
<p>Height Check</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zoning_checks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/zr_run_zoning_checks.html">zr_run_zoning_checks</a></span><span class="op">(</span>bldg_file <span class="op">=</span> <span class="va">bldg_path</span>,</span>
<span>                                      parcel_files <span class="op">=</span> <span class="va">parcel_path</span>,</span>
<span>                                      zoning_files <span class="op">=</span> <span class="va">zoning_path</span>, </span>
<span>                                      checks <span class="op">=</span> <span class="st">"height"</span>,</span>
<span>                                      print_checkpoints <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; zoning checks finished</span></span>
<span><span class="co">#&gt; total runtime: 1.4 sec (0.02 min)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
<p>Building Fit Check</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zoning_checks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/zr_run_zoning_checks.html">zr_run_zoning_checks</a></span><span class="op">(</span>bldg_file <span class="op">=</span> <span class="va">bldg_path</span>,</span>
<span>                                      parcel_files <span class="op">=</span> <span class="va">parcel_path</span>,</span>
<span>                                      zoning_files <span class="op">=</span> <span class="va">zoning_path</span>, </span>
<span>                                      checks <span class="op">=</span> <span class="st">"bldg_fit"</span>,</span>
<span>                                      print_checkpoints <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; zoning checks finished</span></span>
<span><span class="co">#&gt; total runtime: 96.8 sec (1.61 min)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
<p>Many of the “MAYBE” values attached to the bldg_fit constraint represent parcels that didn’t have labeled sides. Without labeled sides, a proper buildable area could not be calculated, and the building fit check was skipped.</p>
<div class="section level4">
<h4 id="detailed-check">Detailed Check<a class="anchor" aria-label="anchor" href="#detailed-check"></a>
</h4>
<p>In addition to the usual data frame that is returned, setting <code>detailed_check = TRUE</code> returns the data frame with additional columns for every check that took place (Note this requires more processing time as the code does not skip consecutive checks if a previous check yields FALSE).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zoning_checks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/zr_run_zoning_checks.html">zr_run_zoning_checks</a></span><span class="op">(</span>bldg_file <span class="op">=</span> <span class="va">bldg_path</span>,</span>
<span>                                      parcel_files <span class="op">=</span> <span class="va">parcel_path</span>,</span>
<span>                                      zoning_files <span class="op">=</span> <span class="va">zoning_path</span>,</span>
<span>                                      detailed_check <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ___data_prep___(0.2 sec)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ___get_zoning_req___(1 sec)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ___initial_checks___(0.5 sec)</span></span>
<span><span class="co">#&gt; 21 parcels are TRUE or MAYBE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ___bldg_fit___(1.57 min)</span></span>
<span><span class="co">#&gt; 221 parcels are TRUE or MAYBE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; _____summary_____</span></span>
<span><span class="co">#&gt; total runtime: 96 sec (1.6 min)</span></span>
<span><span class="co">#&gt; 0 / 421 parcels allow the building</span></span>
<span><span class="co">#&gt; 11 / 421 parcels might allow the building</span></span></code></pre></div>
<p>With these added columns, we can look more closely at why the building does not fit in most of the parcels.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">column_true_sums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">zoning_checks</span><span class="op">)</span> <span class="op">==</span> <span class="st">"TRUE"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ordered_sums</span> <span class="op">&lt;-</span> <span class="va">column_true_sums</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">column_true_sums</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">constraint_check</th>
<th align="right">parcels_true</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">res_type</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">height</td>
<td align="right">97</td>
</tr>
<tr class="odd">
<td align="left">bldg_fit</td>
<td align="right">208</td>
</tr>
<tr class="even">
<td align="left">parcel_side_lbl</td>
<td align="right">254</td>
</tr>
<tr class="odd">
<td align="left">unit_density</td>
<td align="right">297</td>
</tr>
<tr class="even">
<td align="left">stories</td>
<td align="right">397</td>
</tr>
<tr class="odd">
<td align="left">lot_cov_bldg</td>
<td align="right">418</td>
</tr>
<tr class="even">
<td align="left">district_check</td>
<td align="right">421</td>
</tr>
<tr class="odd">
<td align="left">unit_size</td>
<td align="right">421</td>
</tr>
</tbody>
</table>
<p>It appears the res_type constraint is the most restrictive and the unit_size constraint is the least restrictive for the given building.</p>
</div>
</div>
<div class="section level2">
<h2 id="inside-the-zr_run_zoning_checks">Inside the zr_run_zoning_checks()<a class="anchor" aria-label="anchor" href="#inside-the-zr_run_zoning_checks"></a>
</h2>
<p>Most of the functions in zoneR were created for <code><a href="reference/zr_run_zoning_checks.html">zr_run_zoning_checks()</a></code>, but they can be use by themselves if desired. Below are some of the main variables that the different zoneR functions take in.</p>
<ul>
<li><p><strong>bldg_data:</strong> The <code>.bldg</code> file read in as a list using <code><a href="https://rdrr.io/pkg/rjson/man/fromJSON.html" class="external-link">rjson::fromJSON()</a></code></p></li>
<li><p><strong>parcel_dims:</strong> Created with the <code><a href="reference/zr_get_parcel_dims.html">zr_get_parcel_dims()</a></code> function. A simple features data frame with all the centroid and dimensional data from the <code>.parcel</code> file. It contains one row per parcel.</p></li>
<li><p><strong>parcel_data:</strong> One row of the parcel_dims data frame representing a unique parcel</p></li>
<li><p><strong>parcel_geo:</strong> Created with the <code><a href="reference/zr_get_parcel_geo.html">zr_get_parcel_geo()</a></code> function. A simple features data frame containing the geometry of each parcel side without the centroid or dimensional data.</p></li>
<li><p><strong>zoning_data:</strong> The data in the <code>.zoning</code> file read in as a simple features data frame using <code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">sf::st_read()</a></code>.</p></li>
<li><p><strong>district_data:</strong> One row of the zoning_data data frame representing a unique district.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/vibe-lab-gsd/zoneR/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing zoneR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kamryn Mansfield <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kamryn Mansfield.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
